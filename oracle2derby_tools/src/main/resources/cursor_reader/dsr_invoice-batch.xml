<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd 
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd ">
    
    <context:annotation-config/>
    
    <bean id="jdbcCursorItemReader4DSR_INVOICE" class="org.springframework.batch.item.database.JdbcCursorItemReader" scope="step">
    	<property name="dataSource" ref="oracleDS" />
    	<property name="sql" value="SELECT INVOICE_NBR,CREATE_DT,UPDATE_DT,DELETE_DT,UPDATE_ID,LAST_UPDATE_ACTION,AUDIT_LOG_KEY,SYSTEM_ID,SEG_RCVD_DT,DIVISION_ID,INVOICE_COMPANY,INVOICE_SEQ_NBR,INV_LINE_ITEM_CNT,SCN,SHIPTO_CUST_NBR,CUST_INVOICE_NBR,CUSTOMER_PO_NBR,INVOICE_AMT,INVOICE_TAX_AMT,MISC_CHARGE_AMT,PART_TOTAL_AMT,RESTOCK_CHARGE_AMT,COMMISSION_PCT,RELEASE_ID,INSIDE_SLSMN_ID,SLSMN_FIELD,SLSMN_CSM,SLSMN_ASM,SLSMN_CSR,SLSMN_PSS,SLSMN_TAE,SLSMN_MISC1,SLSMN_MISC2,SLSMN_MISC3,SLSMN_MISC4,SLSMN_MISC5,SLSMN_MISC6,SLSMN_MISC7,SLSMN_MISC8,SLSMN_MISC9,ACTUAL_CARRIER_CD,CARRIER_OVERRIDE_TXT,CARRIER_OVRRD_RSN_CD,COD_AMT,FOB_CD,FREIGHT_AMT,FREIGHT_CHARGE_CD,FREIGHT_PROCESSED_FL,MAIL_FL,PACKAGE_QTY,QID_PACKER_CD,SHIP_VIA_CD,SHIP_VIA_OVERRIDE_CD,SHIP_VIA_OVRRD_RSN_CD,SHIP_VIA_OVRRD_RSN_TXT,WEIGHT_LBS,FACILITY_STATUS_DS,INVENTORY_LOC_CD,ORDER_DT,SHIP_DT,SHIP_FIRST_FL,SHIPPER_CREATE_DT,WAYBILL_ID,WRHS_LOC_CD,CREDIT_DEBIT_CD,CUST_TAX_TYPE_CD,PAY_METHOD_CD,PAY_TERMS_CD,TRADE_TERMS_CD,LOCAL_TAX_PCT,STATE_TAX_PCT,TAX_CREDIT_FL,ICST_PO_ID,ICST_TYPE_CD,STATUS_CUTBACK_CNT,STATUS_INSP_CNT,STATUS_INSP_DBL_CNT,STATUS_INSP_TDSK_CNT,STATUS_LARGE_ORDER_CNT,STATUS_PACK_CNT,STATUS_PACK_DE_CNT,STATUS_PRODUCTION_CNT,STATUS_WRHS_TDSK_CNT,TAX_RATE_GEO_STATE_CD,TAX_RATE_GEO_COUNTY_CD,TAX_RATE_GEO_CITY_CD,QID_INSPECTOR1_CD,QID_INSPECTOR2_CD,QID_INSPECTOR3_CD,QID_LAST_UPDATE,ASRS_LAST_PRINT,COMPLETE_2006_FL,COMPLETE_RELEASE_FL,CONFIRM_PURGE_FL,MAG_PRINT_ID,PROM_FL,WMS_CD,SEGMENT_CREATE_CD,INVOICE_CHANGE_AUDIT_KEY,BILLTO_CUST_NBR,CUST_ST_NO,COMPANY_ST_NO,CUST_ACCT_ST_NO,CUST_LOC_ST_NO,FLAT_FREIGHT_AM,FLAT_FRT_CD,IVC_ORIGINAL_NO,FRT_INSUR_AM,FRT_CUST_PARTIAL_AM,STD_HANDLING_AM,SPLIT_PREV_INVOICE_NBR,SPLIT_INVOICE_CD,EMAIL_FL,AUDIT_LOG_DT FROM EMDI.DSR_INVOICE" />
    	<property name="rowMapper">
			<bean class="com.avn.dataload.model.rowmapper.DSR_INVOICERowMapper" />
		</property>
		<property name="fetchSize" value="1000"/>
    </bean>
    
    <bean id="jdbcBatchItemWriter4DSR_INVOICE" class="org.springframework.batch.item.database.JdbcBatchItemWriter">
    	<property name="dataSource" ref="derbyDS" />
    	<property name="itemSqlParameterSourceProvider">
    		<bean class="org.springframework.batch.item.database.BeanPropertyItemSqlParameterSourceProvider" />
    	</property>
    	<property name="sql">
    		<value>
    			<![CDATA[
    				INSERT INTO DSR_INVOICE(INVOICE_NBR,CREATE_DT,UPDATE_DT,DELETE_DT,UPDATE_ID,LAST_UPDATE_ACTION,AUDIT_LOG_KEY,SYSTEM_ID,SEG_RCVD_DT,DIVISION_ID,INVOICE_COMPANY,INVOICE_SEQ_NBR,INV_LINE_ITEM_CNT,SCN,SHIPTO_CUST_NBR,CUST_INVOICE_NBR,CUSTOMER_PO_NBR,INVOICE_AMT,INVOICE_TAX_AMT,MISC_CHARGE_AMT,PART_TOTAL_AMT,RESTOCK_CHARGE_AMT,COMMISSION_PCT,RELEASE_ID,INSIDE_SLSMN_ID,SLSMN_FIELD,SLSMN_CSM,SLSMN_ASM,SLSMN_CSR,SLSMN_PSS,SLSMN_TAE,SLSMN_MISC1,SLSMN_MISC2,SLSMN_MISC3,SLSMN_MISC4,SLSMN_MISC5,SLSMN_MISC6,SLSMN_MISC7,SLSMN_MISC8,SLSMN_MISC9,ACTUAL_CARRIER_CD,CARRIER_OVERRIDE_TXT,CARRIER_OVRRD_RSN_CD,COD_AMT,FOB_CD,FREIGHT_AMT,FREIGHT_CHARGE_CD,FREIGHT_PROCESSED_FL,MAIL_FL,PACKAGE_QTY,QID_PACKER_CD,SHIP_VIA_CD,SHIP_VIA_OVERRIDE_CD,SHIP_VIA_OVRRD_RSN_CD,SHIP_VIA_OVRRD_RSN_TXT,WEIGHT_LBS,FACILITY_STATUS_DS,INVENTORY_LOC_CD,ORDER_DT,SHIP_DT,SHIP_FIRST_FL,SHIPPER_CREATE_DT,WAYBILL_ID,WRHS_LOC_CD,CREDIT_DEBIT_CD,CUST_TAX_TYPE_CD,PAY_METHOD_CD,PAY_TERMS_CD,TRADE_TERMS_CD,LOCAL_TAX_PCT,STATE_TAX_PCT,TAX_CREDIT_FL,ICST_PO_ID,ICST_TYPE_CD,STATUS_CUTBACK_CNT,STATUS_INSP_CNT,STATUS_INSP_DBL_CNT,STATUS_INSP_TDSK_CNT,STATUS_LARGE_ORDER_CNT,STATUS_PACK_CNT,STATUS_PACK_DE_CNT,STATUS_PRODUCTION_CNT,STATUS_WRHS_TDSK_CNT,TAX_RATE_GEO_STATE_CD,TAX_RATE_GEO_COUNTY_CD,TAX_RATE_GEO_CITY_CD,QID_INSPECTOR1_CD,QID_INSPECTOR2_CD,QID_INSPECTOR3_CD,QID_LAST_UPDATE,ASRS_LAST_PRINT,COMPLETE_2006_FL,COMPLETE_RELEASE_FL,CONFIRM_PURGE_FL,MAG_PRINT_ID,PROM_FL,WMS_CD,SEGMENT_CREATE_CD,INVOICE_CHANGE_AUDIT_KEY,BILLTO_CUST_NBR,CUST_ST_NO,COMPANY_ST_NO,CUST_ACCT_ST_NO,CUST_LOC_ST_NO,FLAT_FREIGHT_AM,FLAT_FRT_CD,IVC_ORIGINAL_NO,FRT_INSUR_AM,FRT_CUST_PARTIAL_AM,STD_HANDLING_AM,SPLIT_PREV_INVOICE_NBR,SPLIT_INVOICE_CD,EMAIL_FL,AUDIT_LOG_DT)
    				values (:INVOICE_NBR,:CREATE_DT,:UPDATE_DT,:DELETE_DT,:UPDATE_ID,:LAST_UPDATE_ACTION,:AUDIT_LOG_KEY,:SYSTEM_ID,:SEG_RCVD_DT,:DIVISION_ID,:INVOICE_COMPANY,:INVOICE_SEQ_NBR,:INV_LINE_ITEM_CNT,:SCN,:SHIPTO_CUST_NBR,:CUST_INVOICE_NBR,:CUSTOMER_PO_NBR,:INVOICE_AMT,:INVOICE_TAX_AMT,:MISC_CHARGE_AMT,:PART_TOTAL_AMT,:RESTOCK_CHARGE_AMT,:COMMISSION_PCT,:RELEASE_ID,:INSIDE_SLSMN_ID,:SLSMN_FIELD,:SLSMN_CSM,:SLSMN_ASM,:SLSMN_CSR,:SLSMN_PSS,:SLSMN_TAE,:SLSMN_MISC1,:SLSMN_MISC2,:SLSMN_MISC3,:SLSMN_MISC4,:SLSMN_MISC5,:SLSMN_MISC6,:SLSMN_MISC7,:SLSMN_MISC8,:SLSMN_MISC9,:ACTUAL_CARRIER_CD,:CARRIER_OVERRIDE_TXT,:CARRIER_OVRRD_RSN_CD,:COD_AMT,:FOB_CD,:FREIGHT_AMT,:FREIGHT_CHARGE_CD,:FREIGHT_PROCESSED_FL,:MAIL_FL,:PACKAGE_QTY,:QID_PACKER_CD,:SHIP_VIA_CD,:SHIP_VIA_OVERRIDE_CD,:SHIP_VIA_OVRRD_RSN_CD,:SHIP_VIA_OVRRD_RSN_TXT,:WEIGHT_LBS,:FACILITY_STATUS_DS,:INVENTORY_LOC_CD,:ORDER_DT,:SHIP_DT,:SHIP_FIRST_FL,:SHIPPER_CREATE_DT,:WAYBILL_ID,:WRHS_LOC_CD,:CREDIT_DEBIT_CD,:CUST_TAX_TYPE_CD,:PAY_METHOD_CD,:PAY_TERMS_CD,:TRADE_TERMS_CD,:LOCAL_TAX_PCT,:STATE_TAX_PCT,:TAX_CREDIT_FL,:ICST_PO_ID,:ICST_TYPE_CD,:STATUS_CUTBACK_CNT,:STATUS_INSP_CNT,:STATUS_INSP_DBL_CNT,:STATUS_INSP_TDSK_CNT,:STATUS_LARGE_ORDER_CNT,:STATUS_PACK_CNT,:STATUS_PACK_DE_CNT,:STATUS_PRODUCTION_CNT,:STATUS_WRHS_TDSK_CNT,:TAX_RATE_GEO_STATE_CD,:TAX_RATE_GEO_COUNTY_CD,:TAX_RATE_GEO_CITY_CD,:QID_INSPECTOR1_CD,:QID_INSPECTOR2_CD,:QID_INSPECTOR3_CD,:QID_LAST_UPDATE,:ASRS_LAST_PRINT,:COMPLETE_2006_FL,:COMPLETE_RELEASE_FL,:CONFIRM_PURGE_FL,:MAG_PRINT_ID,:PROM_FL,:WMS_CD,:SEGMENT_CREATE_CD,:INVOICE_CHANGE_AUDIT_KEY,:BILLTO_CUST_NBR,:CUST_ST_NO,:COMPANY_ST_NO,:CUST_ACCT_ST_NO,:CUST_LOC_ST_NO,:FLAT_FREIGHT_AM,:FLAT_FRT_CD,:IVC_ORIGINAL_NO,:FRT_INSUR_AM,:FRT_CUST_PARTIAL_AM,:STD_HANDLING_AM,:SPLIT_PREV_INVOICE_NBR,:SPLIT_INVOICE_CD,:EMAIL_FL,:AUDIT_LOG_DT) 
    			]]>
    		</value>
    	</property>
    </bean>    
    
</beans>